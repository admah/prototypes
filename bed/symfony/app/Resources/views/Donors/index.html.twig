<!DOCTYPE html>
<html class="wvusUikit">
<head>
<title>Prototype Test App</title>

<!-- CSS -->
{% block stylesheets %}
     <link href="{{ asset('bundles/wvusprototype/uikit/css/wvus.uikit.min.css') }}" rel="stylesheet" />
{% endblock %}

<style>
.wvusUikit body {
	padding: 20px;
	background: #f0f0f0;
}

.wvusUikit .app {
	background: #fff;
	-webkit-box-shadow: 0px 0px 10px 1px rgba(102,102,102,0.5);
	-moz-box-shadow: 0px 0px 10px 1px rgba(102,102,102,0.5);
	box-shadow: 0px 0px 10px 1px rgba(102,102,102,0.5);
}

.protofisch img {
	float: left;
	height: 75px;
	width: 75px;
	margin: 0 5px;
	display: block;
	padding: 3px;
	border: 2px solid #000;
	-webkit-border-radius: 50px;
	-moz-border-radius: 50px;
	border-radius: 50px;
	background-color: orange;
}

.protofisch h1 {
	font-size: 42px;
	height: 75px;
	line-height: 75px;
}

</style>

<!-- Include jQuery from CDN -->
<script src="http://code.jquery.com/jquery-1.10.0.min.js"></script>
</head>
<body>
{% if response is defined %}
{{ response }}
{{ json }}
{% endif %}
<div class="wrapper">
	<div class="row">
		<div class="app col-md-8  panel panel-default col-md-offset-2 col-xs-12">
			<div class="panel-body">
				<div class="protofisch">
					<img src="{{ asset('bundles/wvusprototype/images/fisch-icon.png') }}" height="75">
					<h1>Proto-Fisch</h1>
				</div>

				<p>A Simple CRUD App</p>
				<div class="controls pull-right">
					<button class="btn btn-primary" data-toggle="modal" data-target="#createDonor">Create</button>
				</div>
				<table class="table clear-fix table-responsive">
					<thead>
						<tr>
							<th>Name</th>
							<th>Email</th>
							<th>Operations</th>
						</tr>
					</thead>				
	 				<tbody id="donor_list">
	 				  {% for donor in donors %}
	 				  	<tr class="donor-{{ donor.id }}">
						        <td>{{ donor.first_name }} {{ donor.last_name }}</td>
						        <td>{{ donor.email }}</td>
						        <td><a href="" class="btn btn-success" data-toggle="modal" data-id="{{ donor.id }}" data-target="#editDonor">Edit</a> <a href="" class="btn btn-danger" data-toggle="modal" data-id="{{ donor.id }}" data-target="#deleteDonor">Delete</a></td>
						  </tr>
						{% endfor %}				
					</tbody>				
				</table>
				<div class="controls pull-right">
					<button class="btn btn-primary" data-toggle="modal" data-target="#createDonor">Create</button>
				</div>

				<!-- Hidden Modal -->
				<div class="modal fade" id="editDonor" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
					<form>
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									<h4 class="modal-title" id="myModalLabel">Edit Donor Data</h4>
								</div>
								{% for donor in donors %}
								<div class="modal-body">
									<label>First Name</label><br>
									<input type="text" name="first_name" value="{{ donor.first_name }}"><br>
									<label>Last Name</label><br>
									<input type="text" name="last_name" value="{{ donor.first_name }}"><br>
									<label>Email</label><br>
									<input type="text" name="email" value="{{ donor.email }}"><br>
									<label>Phone Number</label><br>
									<input type="text" name="phone"><br>
									<label>Address Line 1</label><br>
									<input type="text" name="address_1"><br>
									<label>Address Line 2</label><br>
									<input type="text" name="address_2"><br>
									<label>City</label><br>
									<input type="text" name="city"><br>
									<label>State</label><br>
									<input type="text" name="state"><br>
									<label>Zip Code</label><br>
									<input type="text" name="zip_code"><br>
								</div>
                {% endfor %}
								<div class="modal-footer">
									<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
									<button type="button" class="btn btn-primary" id="create-button">Save</button>
								</div>
							</div>
						</div>
					</form>
				</div>

				<!-- Hidden Modal -->
				<div class="modal fade" id="createDonor" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
					{% for flashMessage in app.session.flashbag.get('success') %}
	    		<div class="modal fade" id="success" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="false">
						{{ flashMessage }}
					</div>	
					{% endfor %}
					<form id="create-donor" action="{{ path('wvusprototype_create') }}" method="post">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									<h4 class="modal-title" id="myModalLabel">Create Donor Data</h4>
								</div>
								<div class="modal-body">
									<label>First Name</label><br>
									<input type="text" name="first_name"><br>
									<label>Last Name</label><br>
									<input type="text" name="last_name"><br>
									<label>Email</label><br>
									<input type="text" name="email"><br>
									<label>Phone Number</label><br>
									<input type="text" name="phone"><br>
									<label>Address Line 1</label><br>
									<input type="text" name="address_1"><br>
									<label>Address Line 2</label><br>
									<input type="text" name="address_2"><br>
									<label>City</label><br>
									<input type="text" name="city"><br>
									<label>State</label><br>
									<input type="text" name="state"><br>
									<label>Zip Code</label><br>
									<input type="text" name="zip_code"><br>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
									<button type="button" class="btn btn-primary save-action" name="submit">Save</button>
								</div>
							</div>
						</div>
					</form>
				</div>

				<!-- Hidden Modal -->
				<div class="modal fade" id="deleteDonor" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
					<form id="delete-donor" action="{{ path('wvusprototype_delete') }}"">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									<h4 class="modal-title" id="myModalLabel">Delete</h4>
								</div>
								<div class="modal-body">
									Are you sure you want to delete this?
								</div>

								<div class="modal-footer">
									<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
									<button type="button" class="btn btn-primary delete-action">Delete</button>
								</div>
							</div>
						</div>
					</form>
				</div>

			</div>			
		</div>
	</div>
</div>
<!-- Scripts -->
{% block javascripts %}
    <script src="{{ asset('bundles/wvusprototype/uikit/js/jquery.min.js') }}"></script>
    <script src="{{ asset('bundles/wvusprototype/uikit/js/wvus.uikit.min.js') }}"></script>
    <script>
    	$('.save-action, .delete-action').click(function(){
    		$('form#create-donor').submit();
    	});
    	//callback handler for form submit
			$("#create-donor, #delete-donor").submit(function(e)
			{
			    var postData = $(this).serialize();
			    var formURL = $(this).attr("action");
			    $.ajax(
			    {
			        url : formURL,
			        type: "POST",
			        data : postData,
			        success:function(data, textStatus, jqXHR) 
			        {
			            console.log('submitting...');
			            console.log(data);
			        },
			        error: function(data, jqXHR, textStatus, errorThrown) 
			        {
			            console.log(data);      
			        }
			    });
			    e.preventDefault(); //STOP default action
			});
		</script>
{% endblock %}
</body>
</html>